<!DOCTYPE html><html class="h-full antialiased" lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><link rel="preload" as="image" imageSrcSet="/nextImageExportOptimizer/avatar.6162c07b-opt-16.WEBP 16w, /nextImageExportOptimizer/avatar.6162c07b-opt-32.WEBP 32w, /nextImageExportOptimizer/avatar.6162c07b-opt-48.WEBP 48w, /nextImageExportOptimizer/avatar.6162c07b-opt-64.WEBP 64w, /nextImageExportOptimizer/avatar.6162c07b-opt-96.WEBP 96w, /nextImageExportOptimizer/avatar.6162c07b-opt-128.WEBP 128w, /nextImageExportOptimizer/avatar.6162c07b-opt-256.WEBP 256w, /nextImageExportOptimizer/avatar.6162c07b-opt-384.WEBP 384w, /nextImageExportOptimizer/avatar.6162c07b-opt-640.WEBP 640w, /nextImageExportOptimizer/avatar.6162c07b-opt-750.WEBP 750w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 828w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 1080w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 1200w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 1920w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 2048w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 3840w" imageSizes="4rem" data-next-head=""/><title data-next-head="">Median and Mode in Rust - Daniel Butler</title><meta name="description" content="First example in the Rust book. Refactored with ChatGPT 4s help." data-next-head=""/><script>
  let darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)')

  updateMode()
  darkModeMediaQuery.addEventListener('change', updateModeWithoutTransitions)
  window.addEventListener('storage', updateModeWithoutTransitions)

  function updateMode() {
    let isSystemDarkMode = darkModeMediaQuery.matches
    let isDarkMode = window.localStorage.isDarkMode === 'true' || (!('isDarkMode' in window.localStorage) && isSystemDarkMode)

    if (isDarkMode) {
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }

    if (isDarkMode === isSystemDarkMode) {
      delete window.localStorage.isDarkMode
    }
  }

  function disableTransitionsTemporarily() {
    document.documentElement.classList.add('[&_*]:!transition-none')
    window.setTimeout(() => {
      document.documentElement.classList.remove('[&_*]:!transition-none')
    }, 0)
  }

  function updateModeWithoutTransitions() {
    disableTransitionsTemporarily()
    updateMode()
  }
</script><link rel="alternate" type="application/rss+xml" href="https://daniel-butler.com/rss/feed.xml"/><link rel="alternate" type="application/feed+json" href="https://daniel-butler.com/rss/feed.json"/><link rel="preload" href="/_next/static/css/5c9c9fbf178723f1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5c9c9fbf178723f1.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-6224d37324e372cb.js" defer=""></script><script src="/_next/static/chunks/framework-5757d75364ce2279.js" defer=""></script><script src="/_next/static/chunks/main-a5869523d0d5bf46.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2fbe478a729ecc99.js" defer=""></script><script src="/_next/static/chunks/pages/articles/median-and-mode-rust-28a4ab98caac9a07.js" defer=""></script><script src="/_next/static/GPpb1Q_Jz-3w8oamYVch5/_buildManifest.js" defer=""></script><script src="/_next/static/GPpb1Q_Jz-3w8oamYVch5/_ssgManifest.js" defer=""></script></head><body class="flex h-full flex-col bg-zinc-50 dark:bg-black"><div id="__next"><div class="fixed inset-0 flex justify-center sm:px-8"><div class="flex w-full max-w-7xl lg:px-8"><div class="w-full bg-white ring-1 ring-zinc-100 dark:bg-zinc-900 dark:ring-zinc-300/20"></div></div></div><div class="relative"><header class="pointer-events-none relative z-50 flex flex-col" style="height:var(--header-height);margin-bottom:var(--header-mb)"><div class="order-last mt-[calc(theme(spacing.16)-theme(spacing.3))]"></div><div class="sm:px-8 top-0 order-last -mb-3 pt-3" style="position:var(--header-position)"><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="top-[var(--avatar-top,theme(spacing.3))] w-full" style="position:var(--header-inner-position)"><div class="relative"><div class="absolute left-0 top-3 origin-left transition-opacity h-10 w-10 rounded-full bg-white/90 p-0.5 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:ring-white/10" style="opacity:var(--avatar-border-opacity, 0);transform:var(--avatar-border-transform)"></div><a aria-label="Home" class="block h-16 w-16 origin-left pointer-events-auto" style="transform:var(--avatar-image-transform)" href="/"><img alt="" width="800" height="800" decoding="async" data-nimg="1" class="rounded-full bg-zinc-100 object-cover dark:bg-zinc-800 h-16 w-16" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;/nextImageExportOptimizer/avatar.6162c07b-opt-10.WEBP&quot;)" sizes="4rem" srcSet="/nextImageExportOptimizer/avatar.6162c07b-opt-16.WEBP 16w, /nextImageExportOptimizer/avatar.6162c07b-opt-32.WEBP 32w, /nextImageExportOptimizer/avatar.6162c07b-opt-48.WEBP 48w, /nextImageExportOptimizer/avatar.6162c07b-opt-64.WEBP 64w, /nextImageExportOptimizer/avatar.6162c07b-opt-96.WEBP 96w, /nextImageExportOptimizer/avatar.6162c07b-opt-128.WEBP 128w, /nextImageExportOptimizer/avatar.6162c07b-opt-256.WEBP 256w, /nextImageExportOptimizer/avatar.6162c07b-opt-384.WEBP 384w, /nextImageExportOptimizer/avatar.6162c07b-opt-640.WEBP 640w, /nextImageExportOptimizer/avatar.6162c07b-opt-750.WEBP 750w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 828w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 1080w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 1200w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 1920w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 2048w, /nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP 3840w" src="/nextImageExportOptimizer/avatar.6162c07b-opt-828.WEBP"/></a></div></div></div></div></div></div><div class="top-0 z-10 h-16 pt-6" style="position:var(--header-position)"><div class="sm:px-8 top-[var(--header-top,theme(spacing.6))] w-full" style="position:var(--header-inner-position)"><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="relative flex gap-4"><div class="flex flex-1"></div><div class="flex flex-1 justify-end md:justify-center"><div class="pointer-events-auto md:hidden" data-headlessui-state=""><button class="group flex items-center rounded-full bg-white/90 px-4 py-2 text-sm font-medium text-zinc-800 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:text-zinc-200 dark:ring-white/10 dark:hover:ring-white/20" type="button" aria-expanded="false" data-headlessui-state="">Menu<svg viewBox="0 0 8 6" aria-hidden="true" class="ml-3 h-auto w-2 stroke-zinc-500 group-hover:stroke-zinc-700 dark:group-hover:stroke-zinc-400"><path d="M1.75 1.75 4 4.25l2.25-2.5" fill="none" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div><span hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></span><nav class="pointer-events-auto hidden md:block"><ul class="flex rounded-full bg-white/90 px-3 text-sm font-medium text-zinc-800 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:text-zinc-200 dark:ring-white/10"><li><a class="relative block px-3 py-2 transition text-teal-500 dark:text-teal-400" href="/">Home<span class="absolute inset-x-1 -bottom-px h-px bg-gradient-to-r from-teal-500/0 via-teal-500/40 to-teal-500/0 dark:from-teal-400/0 dark:via-teal-400/40 dark:to-teal-400/0"></span></a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/about">About</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/articles">Articles</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/projects">Projects</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/platforms">Platforms</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/speaking">Speaking</a></li></ul></nav></div><div class="flex justify-end md:flex-1"><div class="pointer-events-auto"><button type="button" aria-label="Toggle dark mode" class="group rounded-full bg-white/90 px-3 py-2 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur transition dark:bg-zinc-800/90 dark:ring-white/10 dark:hover:ring-white/20"><svg viewBox="0 0 24 24" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" class="h-6 w-6 fill-zinc-100 stroke-zinc-500 transition group-hover:fill-zinc-200 group-hover:stroke-zinc-700 dark:hidden [@media(prefers-color-scheme:dark)]:fill-teal-50 [@media(prefers-color-scheme:dark)]:stroke-teal-500 [@media(prefers-color-scheme:dark)]:group-hover:fill-teal-50 [@media(prefers-color-scheme:dark)]:group-hover:stroke-teal-600"><path d="M8 12.25A4.25 4.25 0 0 1 12.25 8v0a4.25 4.25 0 0 1 4.25 4.25v0a4.25 4.25 0 0 1-4.25 4.25v0A4.25 4.25 0 0 1 8 12.25v0Z"></path><path d="M12.25 3v1.5M21.5 12.25H20M18.791 18.791l-1.06-1.06M18.791 5.709l-1.06 1.06M12.25 20v1.5M4.5 12.25H3M6.77 6.77 5.709 5.709M6.77 17.73l-1.061 1.061" fill="none"></path></svg><svg viewBox="0 0 24 24" aria-hidden="true" class="hidden h-6 w-6 fill-zinc-700 stroke-zinc-500 transition dark:block [@media(prefers-color-scheme:dark)]:group-hover:stroke-zinc-400 [@media_not_(prefers-color-scheme:dark)]:fill-teal-400/10 [@media_not_(prefers-color-scheme:dark)]:stroke-teal-500"><path d="M17.25 16.22a6.937 6.937 0 0 1-9.47-9.47 7.451 7.451 0 1 0 9.47 9.47ZM12.75 7C17 7 17 2.75 17 2.75S17 7 21.25 7C17 7 17 11.25 17 11.25S17 7 12.75 7Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div></div></div></div></div></div></div></header><div style="height:var(--content-offset)"></div><main><div class="sm:px-8 mt-16 lg:mt-32"><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="xl:relative"><div class="mx-auto max-w-2xl"><article><header class="flex flex-col"><h1 class="mt-6 text-4xl font-bold tracking-tight text-zinc-800 dark:text-zinc-100 sm:text-5xl">Median and Mode in Rust</h1><time dateTime="2023-03-05" class="order-first flex items-center text-base text-zinc-400 dark:text-zinc-500"><span class="h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span><span class="ml-3">March 5, 2023</span></time></header><div class="mt-8 prose dark:prose-invert"><p>This is the second example I&#x27;m working on from the <a href="https://doc.rust-lang.org/stable/book/ch08-03-hash-maps.html#summary">rust book</a>.</p>
<p>In python, I&#x27;ve used the statistics standard library module as the test case to validate the code written in the &quot;brute force method&quot;. If this was production code, I would use the statistics module instead of rolling my own.</p>
<h2>Problem Statement</h2>
<p>Given a list of integers, use a vector and return the median (when sorted, the value in the middle position) and mode (the value that occurs most often; a hash map will be helpful here) of the list.</p>
<h3>Input</h3>
<pre><code>[13, 8, 2, 21, 21, 6, 27, 15, 14, 22, 17, 16, 7, 15, 12, 10, 25, 21, 27, 29, 17, 29, 26, 10, 14, 11, 23, 8, 27, 4]
</code></pre>
<h1>Median</h1>
<p>What we are looking for is when sorted, the value in the middle position of an array of numbers. When there are an even number of values in the array then find the middle value between the two middle entries.</p>
<h2>Python</h2>
<pre><code class="hljs language-python">nums = [
		<span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">21</span>, <span class="hljs-number">21</span>, <span class="hljs-number">6</span>, <span class="hljs-number">27</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">22</span>, <span class="hljs-number">17</span>, <span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>, <span class="hljs-number">21</span>, <span class="hljs-number">27</span>, <span class="hljs-number">29</span>, <span class="hljs-number">17</span>, <span class="hljs-number">29</span>, <span class="hljs-number">26</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">23</span>, <span class="hljs-number">8</span>, <span class="hljs-number">27</span>, <span class="hljs-number">4</span>
]

nums = <span class="hljs-built_in">sorted</span>(nums)

<span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(nums) % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:
	median = nums[<span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(nums)/<span class="hljs-number">2</span>)]
<span class="hljs-keyword">else</span>:
	middle_index = <span class="hljs-built_in">len</span>(nums) / <span class="hljs-number">2</span>
	first_index = <span class="hljs-built_in">int</span>(middle_index - <span class="hljs-number">.5</span>)
	second_index = <span class="hljs-built_in">int</span>(middle_index + <span class="hljs-number">.5</span>)
	median = (nums[first_index]+nums[second_index])/<span class="hljs-number">2</span>

<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Median Brute method: <span class="hljs-subst">{median}</span>&quot;</span>)

<span class="hljs-keyword">import</span> statistics
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Median Standard library method: <span class="hljs-subst">{statistics.median(nums)}</span>&quot;</span>)
</code></pre>
<p>Output</p>
<pre><code>Median Brute method: 15.5
Median Standard library method: 15.5
</code></pre>
<h2>Rust</h2>
<pre><code class="hljs language-rust"><span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
	<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">nums</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">21</span>, <span class="hljs-number">21</span>, <span class="hljs-number">6</span>, <span class="hljs-number">27</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">22</span>, <span class="hljs-number">17</span>, <span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>, <span class="hljs-number">21</span>, <span class="hljs-number">27</span>, <span class="hljs-number">29</span>, <span class="hljs-number">17</span>, <span class="hljs-number">29</span>, <span class="hljs-number">26</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">23</span>, <span class="hljs-number">8</span>, <span class="hljs-number">27</span>, <span class="hljs-number">4</span>];

	nums.<span class="hljs-title function_ invoke__">sort</span>();
	<span class="hljs-built_in">print!</span>(<span class="hljs-string">&quot;Median: {}&quot;</span>, <span class="hljs-title function_ invoke__">median</span>(&amp;nums))
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">median</span>(nums: &amp;<span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u32</span>&gt;) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">f32</span> {
	<span class="hljs-keyword">let</span> <span class="hljs-variable">length</span>: <span class="hljs-type">f32</span>= nums.<span class="hljs-title function_ invoke__">len</span>() <span class="hljs-keyword">as</span> <span class="hljs-type">f32</span>;
	<span class="hljs-keyword">let</span> <span class="hljs-variable">middle_index</span>: <span class="hljs-type">f32</span> = length / <span class="hljs-number">2</span>.;
	
	<span class="hljs-keyword">match</span> nums.<span class="hljs-title function_ invoke__">len</span>() % <span class="hljs-number">2</span> {
		<span class="hljs-number">0</span> =&gt; {
			<span class="hljs-keyword">let</span> <span class="hljs-variable">first</span>= nums[(middle_index - <span class="hljs-number">0.5</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">u32</span> <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span>];
			<span class="hljs-keyword">let</span> <span class="hljs-variable">second</span> = nums[(middle_index + <span class="hljs-number">0.5</span>) <span class="hljs-keyword">as</span> <span class="hljs-type">u32</span> <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span>];
			<span class="hljs-title function_ invoke__">return</span> (first <span class="hljs-keyword">as</span> <span class="hljs-type">f32</span> + second <span class="hljs-keyword">as</span> <span class="hljs-type">f32</span>) / <span class="hljs-number">2</span>.
		}
		_ =&gt; {
			<span class="hljs-keyword">return</span> nums[middle_index <span class="hljs-keyword">as</span> <span class="hljs-type">u32</span> <span class="hljs-keyword">as</span> <span class="hljs-type">usize</span>] <span class="hljs-keyword">as</span> <span class="hljs-type">f32</span>
		}
	}
}
</code></pre>
<p>Output</p>
<pre><code>Median: 15.5
</code></pre>
<h2>Challenges</h2>
<p>Not understanding Scope and types being returned. My solution was to put the logic into its own function.</p>
<pre><code>error[E0425]: cannot find value `median` in this scope
  --&gt; compiler.rs:21:23
   |
21 |     print!(&quot;Median: {}&quot;, median)
   |                          ^^^^^^ not found in this scope
</code></pre>
<p>Numbers are not all the same type. I solved it by casting the numbers into the proper type. Sometimes casting the numbers twice because <code>f32</code> can&#x27;t be cast into <code>usize</code> type. <a href="https://stackoverflow.com/a/44552464/7838574">This stack overflow</a> helped get me to the solution.</p>
<pre><code>error[E0277]: cannot subtract `{float}` from `usize`
  --&gt; compiler.rs:12:34
   |
12 |             let first = nums[middle_index - 0.5];
   |                                           ^ no implementation for `usize - {float}`
</code></pre>
<h1>Mode</h1>
<h2>Python</h2>
<pre><code class="hljs language-python">nums = [
		<span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">21</span>, <span class="hljs-number">21</span>, <span class="hljs-number">6</span>, <span class="hljs-number">27</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">22</span>, <span class="hljs-number">17</span>, <span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>, <span class="hljs-number">21</span>, <span class="hljs-number">27</span>, <span class="hljs-number">29</span>, <span class="hljs-number">17</span>, <span class="hljs-number">29</span>, <span class="hljs-number">26</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">23</span>, <span class="hljs-number">8</span>, <span class="hljs-number">27</span>, <span class="hljs-number">4</span>
]

count_dict = {}
<span class="hljs-keyword">for</span> num <span class="hljs-keyword">in</span> nums:
	count_dict[num] = count_dict.get(num, <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>
	
mode_dict = {}
highest = <span class="hljs-number">0</span>
<span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">in</span> count_dict.items():
	val_list = mode_dict.get(value, [])
	val_list.append(key)
	mode_dict[value] = val_list
	<span class="hljs-keyword">if</span> value &gt; highest:
		highest = value

<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Mode Brute force method: <span class="hljs-subst">{mode_dict[highest]}</span>&quot;</span>)

<span class="hljs-keyword">import</span> statistics
<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Mode Standard library method: <span class="hljs-subst">{statistics.mode(nums)}</span>&quot;</span>)
</code></pre>
<p>Output</p>
<pre><code>Mode Brute force method: [21, 27]

statistics.StatisticsError: no unique mode; found 2 equally common values
</code></pre>
<p>The statistics standard library throws an error because there are two most common values.</p>
<h2>Rust</h2>
<pre><code class="hljs language-rust"><span class="hljs-keyword">use</span> std::collections::HashMap;

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() {
	<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">nums</span> = <span class="hljs-built_in">vec!</span>[<span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">21</span>, <span class="hljs-number">21</span>, <span class="hljs-number">6</span>, <span class="hljs-number">27</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">22</span>, <span class="hljs-number">17</span>, <span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>, <span class="hljs-number">21</span>, <span class="hljs-number">27</span>, <span class="hljs-number">29</span>, <span class="hljs-number">17</span>, <span class="hljs-number">29</span>, <span class="hljs-number">26</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">23</span>, <span class="hljs-number">8</span>, <span class="hljs-number">27</span>, <span class="hljs-number">4</span>];
	
	<span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Mode: {:?}&quot;</span>, <span class="hljs-title function_ invoke__">mode</span>(&amp;nums));
}

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">mode</span>(nums: &amp;<span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u32</span>&gt;) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u32</span>&gt; {
	<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">counter</span> = HashMap::<span class="hljs-title function_ invoke__">new</span>();
	
	<span class="hljs-keyword">for</span> <span class="hljs-variable">num</span> <span class="hljs-keyword">in</span> nums {
		<span class="hljs-keyword">match</span> counter.<span class="hljs-title function_ invoke__">get</span>(&amp;num) {
			<span class="hljs-title function_ invoke__">Some</span>(count) =&gt; counter.<span class="hljs-title function_ invoke__">insert</span>(num, count + <span class="hljs-number">1</span>),
			<span class="hljs-literal">None</span> =&gt; counter.<span class="hljs-title function_ invoke__">insert</span>(num, <span class="hljs-number">1</span>)
		};
	}

	<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">moder</span>: HashMap&lt;<span class="hljs-type">u32</span>, <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u32</span>&gt;&gt; = HashMap::<span class="hljs-title function_ invoke__">new</span>();
	<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">highest</span> = <span class="hljs-number">0</span>;
	<span class="hljs-keyword">for</span> (key, value) <span class="hljs-keyword">in</span> &amp;counter {
		<span class="hljs-keyword">if</span> value &gt; &amp;highest {
			highest = *value;
		}
		<span class="hljs-keyword">match</span> moder.<span class="hljs-title function_ invoke__">get_mut</span>(&amp;value) {
			<span class="hljs-title function_ invoke__">Some</span>(keys) =&gt; {
				<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">ks</span> = keys.<span class="hljs-title function_ invoke__">to_vec</span>();
				ks.<span class="hljs-title function_ invoke__">push</span>(**key);
				moder.<span class="hljs-title function_ invoke__">insert</span>(*value, ks);
			},
			<span class="hljs-literal">None</span> =&gt; {
				<span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">keys</span> = <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>();
				keys.<span class="hljs-title function_ invoke__">push</span>(**key);
				moder.<span class="hljs-title function_ invoke__">insert</span>(*value, keys);
			}
		};
	}
	
	<span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> <span class="hljs-variable">Some</span>(keys) = moder.<span class="hljs-title function_ invoke__">get</span>(&amp;highest) {
		<span class="hljs-keyword">return</span> keys.<span class="hljs-title function_ invoke__">to_vec</span>()
	} <span class="hljs-keyword">else</span> {
		<span class="hljs-keyword">return</span> <span class="hljs-type">Vec</span>::<span class="hljs-title function_ invoke__">new</span>()
	};
}
</code></pre>
<p>When I asked ChatGPT how I can make the code more idiomatic. This was the response</p>
<blockquote>
<p>Here are some suggestions to make the Rust code more idiomatic:</p>
<ol>
<li>Use a <code>&amp;[u32]</code> slice instead of a <code>Vec&lt;u32&gt;</code> for the function parameters. This allows the function to accept both a <code>Vec&lt;u32&gt;</code> and a slice, which is more flexible.</li>
<li>Use <code>unwrap_or</code> instead of the <code>match</code> statement in the <code>mode</code> function to insert a value into the hash map with a default value of 1 if the key does not exist.</li>
<li>Use <code>entry</code> method to insert or update values in the hash map.</li>
<li>Use <code>iter()</code> method instead of a reference to iterate over the vector elements.</li>
<li>Use <code>collect</code> method to convert an iterator to a vector.</li>
<li>Use <code>copied</code> method to create an iterator over the copied elements.</li>
<li>Use <code>cloned</code> method to create an iterator over the cloned elements.</li>
</ol>
<p>Here&#x27;s the updated code:</p>
</blockquote>
<pre><code class="hljs language-rust"><span class="hljs-keyword">use</span> std::collections::HashMap; 

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">main</span>() { 
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">nums</span> = <span class="hljs-built_in">vec!</span>[ <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">21</span>, <span class="hljs-number">21</span>, <span class="hljs-number">6</span>, <span class="hljs-number">27</span>, <span class="hljs-number">15</span>, <span class="hljs-number">14</span>, <span class="hljs-number">22</span>, <span class="hljs-number">17</span>, <span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">15</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>, <span class="hljs-number">25</span>, <span class="hljs-number">21</span>, <span class="hljs-number">27</span>, <span class="hljs-number">29</span>, <span class="hljs-number">17</span>, <span class="hljs-number">29</span>, <span class="hljs-number">26</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">11</span>, <span class="hljs-number">23</span>, <span class="hljs-number">8</span>, <span class="hljs-number">27</span>, <span class="hljs-number">4</span>, ]; 
    nums.<span class="hljs-title function_ invoke__">sort</span>(); 
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Median: {}&quot;</span>, <span class="hljs-title function_ invoke__">median</span>(&amp;nums));
    <span class="hljs-built_in">println!</span>(<span class="hljs-string">&quot;Mode: {:?}&quot;</span>, <span class="hljs-title function_ invoke__">mode</span>(&amp;nums)); 
} 

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">median</span>(nums: &amp;[<span class="hljs-type">u32</span>]) <span class="hljs-punctuation">-&gt;</span> <span class="hljs-type">f32</span> { 
    <span class="hljs-keyword">let</span> <span class="hljs-variable">length</span> = nums.<span class="hljs-title function_ invoke__">len</span>(); 
    <span class="hljs-keyword">match</span> length % <span class="hljs-number">2</span> { 
        <span class="hljs-number">0</span> =&gt; { 
            <span class="hljs-keyword">let</span> <span class="hljs-variable">first</span> = nums[(length / <span class="hljs-number">2</span>) - <span class="hljs-number">1</span>]; 
            <span class="hljs-keyword">let</span> <span class="hljs-variable">second</span> = nums[length / <span class="hljs-number">2</span>]; 
            (first asf32 + second <span class="hljs-keyword">as</span> <span class="hljs-type">f32</span>) / <span class="hljs-number">2</span>.
         },
         _ =&gt; nums[length / <span class="hljs-number">2</span>] <span class="hljs-keyword">as</span> <span class="hljs-type">f32</span>, 
    } 
} 

<span class="hljs-keyword">fn</span> <span class="hljs-title function_">mode</span>(nums: &amp;[<span class="hljs-type">u32</span>]) <span class="hljs-punctuation">-&gt;</span><span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u32</span>&gt; { 
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">counter</span> = HashMap::<span class="hljs-title function_ invoke__">new</span>(); 
    <span class="hljs-keyword">for</span> <span class="hljs-variable">num</span> <span class="hljs-keyword">in</span> nums.<span class="hljs-title function_ invoke__">iter</span>() { 
        *counter.<span class="hljs-title function_ invoke__">entry</span>(num).<span class="hljs-title function_ invoke__">or_insert</span>(<span class="hljs-number">0</span>) += <span class="hljs-number">1</span>; 
    } 
    
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">moder</span>: HashMap&lt;<span class="hljs-type">u32</span>, <span class="hljs-type">Vec</span>&lt;<span class="hljs-type">u32</span>&gt;&gt; = HashMap::<span class="hljs-title function_ invoke__">new</span>(); 
    <span class="hljs-keyword">let</span> <span class="hljs-keyword">mut </span><span class="hljs-variable">highest</span> = <span class="hljs-number">0</span>; 
    <span class="hljs-keyword">for</span> (key, value) <span class="hljs-keyword">in</span> &amp;counter { 
        <span class="hljs-keyword">if</span> value &gt; &amp;highest { 
            highest = *value; 
        } 
        moder.<span class="hljs-title function_ invoke__">entry</span>(*value).<span class="hljs-title function_ invoke__">or_insert_with</span>(<span class="hljs-type">Vec</span>::new).<span class="hljs-title function_ invoke__">push</span>(*key); 
    } 
    moder.<span class="hljs-title function_ invoke__">get</span>(&amp;highest).<span class="hljs-title function_ invoke__">copied</span>().<span class="hljs-title function_ invoke__">unwrap_or_default</span>().<span class="hljs-title function_ invoke__">collect</span>() 
}
</code></pre>
<p>When running the program it produced the following errors</p>
<pre><code>error[E0308]: mismatched types
  --&gt; compiler.rs:41:59
   |
41 |         moder.entry(*value).or_insert_with(Vec::new).push(*key);
   |                                                      ---- ^^^^ expected `u32`, found `&amp;u32`
   |                                                      |
   |                                                      arguments to this function are incorrect
   |
note: associated function defined here
help: consider dereferencing the borrow
   |
41 |         moder.entry(*value).or_insert_with(Vec::new).push(**key);
   |                                                           +

error[E0277]: the trait bound `Vec&lt;u32&gt;: Copy` is not satisfied
  --&gt; compiler.rs:44:25
   |
44 |     moder.get(&amp;highest).copied().unwrap_or_default().collect()
   |                         ^^^^^^ the trait `Copy` is not implemented for `Vec&lt;u32&gt;`
   |
note: required by a bound in `Option::&lt;&amp;T&gt;::copied`

error[E0599]: `Vec&lt;u32&gt;` is not an iterator
  --&gt; compiler.rs:44:54
   |
44 |       moder.get(&amp;highest).copied().unwrap_or_default().collect()
   |                                                        ^^^^^^^ `Vec&lt;u32&gt;` is not an iterator; try calling `.into_iter()` or `.iter()`
   |
   = note: the following trait bounds were not satisfied:
           `Vec&lt;u32&gt;: Iterator`
           which is required by `&amp;mut Vec&lt;u32&gt;: Iterator`
           `[u32]: Iterator`
           which is required by `&amp;mut [u32]: Iterator`

error: aborting due to 3 previous errors

Some errors have detailed explanations: E0277, E0308, E0599.
For more information about an error, try `rustc --explain E0277`.
</code></pre>
<p>The first error complaining about using a <code>&amp;key</code> was easy to fix with another deference. The second error related to copying the <code>Vec&lt;u32&gt;</code> , a type on the heap, was fixed by cloning instead. <a href="https://stackoverflow.com/a/63127877/7838574">This stack overflow answer</a> helped figure that one out.</p>
<p>What did I learn from ChatGPTs revision?</p>
<ul>
<li>When borrowing a vector it it&#x27;s probably best to use a slice. <a href="https://stackoverflow.com/a/32573802/7838574">This stack overflow</a> elucidates it well.</li>
<li>Hashmap&#x27;s <code>Entry</code>&#x27;s are extremely helpful.</li>
</ul>
<blockquote>
<p>Ensures a value is in the entry by inserting the default if empty, and returns a mutable reference to the value in the entry. <a href="https://doc.rust-lang.org/std/collections/hash_map/enum.Entry.html">Rust docs</a></p>
</blockquote></div></article></div></div></div></div></div></div></main><footer class="mt-32"><div class="sm:px-8"><div class="mx-auto max-w-7xl lg:px-8"><div class="border-t border-zinc-100 pt-10 pb-16 dark:border-zinc-700/40"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex flex-col items-center justify-between gap-6 sm:flex-row"><div class="flex gap-6 text-sm font-medium text-zinc-800 dark:text-zinc-200"><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/about">About</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/articles">Articles</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/projects">Projects</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/platforms">Platforms</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/speaking">Speaking</a></div><p class="text-sm text-zinc-400 dark:text-zinc-500">© <!-- -->2025<!-- --> Daniel Butler. All rights reserved.</p></div></div></div></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/articles/median-and-mode-rust","query":{},"buildId":"GPpb1Q_Jz-3w8oamYVch5","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>