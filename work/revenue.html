<!DOCTYPE html><html class="h-full antialiased" lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">Revenue - Daniel Butler</title><meta name="description" content="A webapp that optimizes workflows of integral daily and monthly accounting processes." data-next-head=""/><script>
  let darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)')

  updateMode()
  darkModeMediaQuery.addEventListener('change', updateModeWithoutTransitions)
  window.addEventListener('storage', updateModeWithoutTransitions)

  function updateMode() {
    let isSystemDarkMode = darkModeMediaQuery.matches
    let isDarkMode = window.localStorage.isDarkMode === 'true' || (!('isDarkMode' in window.localStorage) && isSystemDarkMode)

    if (isDarkMode) {
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }

    if (isDarkMode === isSystemDarkMode) {
      delete window.localStorage.isDarkMode
    }
  }

  function disableTransitionsTemporarily() {
    document.documentElement.classList.add('[&_*]:!transition-none')
    window.setTimeout(() => {
      document.documentElement.classList.remove('[&_*]:!transition-none')
    }, 0)
  }

  function updateModeWithoutTransitions() {
    disableTransitionsTemporarily()
    updateMode()
  }
</script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,400;0,500;0,600;1,400&amp;display=swap" rel="stylesheet"/><link rel="alternate" type="application/rss+xml" href="https://daniel-butler.com/rss/feed.xml"/><link rel="alternate" type="application/feed+json" href="https://daniel-butler.com/rss/feed.json"/><link rel="preload" href="/_next/static/css/a95412744f648984.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a95412744f648984.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-5e931bb610e47be1.js" defer=""></script><script src="/_next/static/chunks/framework-37f3832b4337c515.js" defer=""></script><script src="/_next/static/chunks/main-0b49c1a760b53436.js" defer=""></script><script src="/_next/static/chunks/pages/_app-15715b6efab12d60.js" defer=""></script><script src="/_next/static/chunks/351-b029ed6d10502a7c.js" defer=""></script><script src="/_next/static/chunks/pages/work/revenue-b2f2ffda49319950.js" defer=""></script><script src="/_next/static/XO_mZs14RMa7XL1ztH67e/_buildManifest.js" defer=""></script><script src="/_next/static/XO_mZs14RMa7XL1ztH67e/_ssgManifest.js" defer=""></script></head><body class="flex h-full flex-col bg-zinc-50 dark:bg-black"><div id="__next"><div class="min-h-screen bg-white dark:bg-zinc-950"><header class="border-b border-zinc-100 dark:border-zinc-800"><div class="sm:px-8"><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex items-center justify-between py-4"><div class="flex-shrink-0"><a class="text-base font-bold tracking-tight text-zinc-800 hover:text-teal-500 dark:text-zinc-200 dark:hover:text-teal-400 transition" href="/">Daniel Butler</a></div><nav class="hidden sm:block"><ul class="flex items-center"><li><a class="relative block px-3 py-2 text-sm transition text-zinc-600 hover:text-teal-500 dark:text-zinc-400 dark:hover:text-teal-400" href="/about">About</a></li><li><a class="relative block px-3 py-2 text-sm transition text-zinc-600 hover:text-teal-500 dark:text-zinc-400 dark:hover:text-teal-400" href="/articles">Blog</a></li><li><a class="relative block px-3 py-2 text-sm transition text-zinc-600 hover:text-teal-500 dark:text-zinc-400 dark:hover:text-teal-400" href="/work">Work</a></li></ul></nav><div class="flex items-center gap-2"><nav class="sm:hidden"><ul class="flex items-center"><li><a class="relative block px-3 py-2 text-sm transition text-zinc-600 hover:text-teal-500 dark:text-zinc-400 dark:hover:text-teal-400" href="/about">About</a></li><li><a class="relative block px-3 py-2 text-sm transition text-zinc-600 hover:text-teal-500 dark:text-zinc-400 dark:hover:text-teal-400" href="/articles">Blog</a></li><li><a class="relative block px-3 py-2 text-sm transition text-zinc-600 hover:text-teal-500 dark:text-zinc-400 dark:hover:text-teal-400" href="/work">Work</a></li></ul></nav><button type="button" aria-label="Toggle dark mode" class="group rounded-full bg-white/90 px-3 py-2 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur transition dark:bg-zinc-800/90 dark:ring-white/10 dark:hover:ring-white/20"><svg viewBox="0 0 24 24" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" class="h-6 w-6 fill-zinc-100 stroke-zinc-500 transition group-hover:fill-zinc-200 group-hover:stroke-zinc-700 dark:hidden [@media(prefers-color-scheme:dark)]:fill-teal-50 [@media(prefers-color-scheme:dark)]:stroke-teal-500 [@media(prefers-color-scheme:dark)]:group-hover:fill-teal-50 [@media(prefers-color-scheme:dark)]:group-hover:stroke-teal-600"><path d="M8 12.25A4.25 4.25 0 0 1 12.25 8v0a4.25 4.25 0 0 1 4.25 4.25v0a4.25 4.25 0 0 1-4.25 4.25v0A4.25 4.25 0 0 1 8 12.25v0Z"></path><path d="M12.25 3v1.5M21.5 12.25H20M18.791 18.791l-1.06-1.06M18.791 5.709l-1.06 1.06M12.25 20v1.5M4.5 12.25H3M6.77 6.77 5.709 5.709M6.77 17.73l-1.061 1.061" fill="none"></path></svg><svg viewBox="0 0 24 24" aria-hidden="true" class="hidden h-6 w-6 fill-zinc-700 stroke-zinc-500 transition dark:block [@media(prefers-color-scheme:dark)]:group-hover:stroke-zinc-400 [@media_not_(prefers-color-scheme:dark)]:fill-teal-400/10 [@media_not_(prefers-color-scheme:dark)]:stroke-teal-500"><path d="M17.25 16.22a6.937 6.937 0 0 1-9.47-9.47 7.451 7.451 0 1 0 9.47 9.47ZM12.75 7C17 7 17 2.75 17 2.75S17 7 21.25 7C17 7 17 11.25 17 11.25S17 7 12.75 7Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div></div></div></div></div></div></header><main><div class="sm:px-8 mt-16 lg:mt-32"><div class="mx-auto max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="xl:relative"><div class="mx-auto max-w-2xl"><article><header class="flex flex-col"><h1 class="mt-6 text-4xl font-bold tracking-tight text-zinc-800 dark:text-zinc-100 sm:text-5xl">Revenue</h1><time dateTime="2020-05-15" class="order-first flex items-center text-base text-zinc-400 dark:text-zinc-500"><span class="h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span><span class="ml-3">May 15, 2020</span></time></header><div class="mt-8 prose dark:prose-invert"><h2>Overview</h2>
<p>The project was a webpage that automated the most difficult and tedious journal entries the revenue team had to complete.
Additionally, aggregated aging data across the various entities tracked separately in the accounting system.
The combined aging data was used to streamline the month end closing process.</p>
<img alt="Main page" loading="lazy" width="1670" height="969" decoding="async" data-nimg="1" style="color:transparent;background-size:cover;background-position:50% 50%;background-repeat:no-repeat;background-image:url(&quot;/nextImageExportOptimizer/revenue-landing-page.c2f1dda1-opt-10.WEBP&quot;)" srcSet="/nextImageExportOptimizer/revenue-landing-page.c2f1dda1-opt-1920.WEBP 1x, /nextImageExportOptimizer/revenue-landing-page.c2f1dda1-opt-1920.WEBP 2x" src="/nextImageExportOptimizer/revenue-landing-page.c2f1dda1-opt-1920.WEBP"/>
<p>The CORE Group had close to twenty different legal entities each with their own set of books.
The customers would make a payment (or multiple payments) to one of the entities.
When the accounting department booked the revenue to properly recognize the revenue the payment had to split between the entities.</p>
<h2>Features and Value added</h2>
<h3>Automated Journal Entries</h3>
<p>The webpage took an Excel file broken down by location and generated the various intercompany and Customer Invoice entries to clean up the Customer Aging.
The webpage was processed by the backend server to pull out the relevant data reducing the fields needed to be entered.
The final result was a csv file that was imported into each Company&#x27;s accounting system.</p>
<h3>Aging</h3>
<p>The Aging is a report of entries that do not have a corresponding offsetting entry in the books, or they have not been applied.
This is a standard Accounting report generated by accounting systems.
The complexity for the CORE Group was that there were close to twenty of these reports each could have information related to the other one.
The Aging page combined all the entities into a single report to make reconciliation easier.</p>
<video class="w-max"><source src="/media/revenue-demo-video.mp4" type="video/mp4" controls=""/><p>The browser does not support the video tag unfortunately.</p></video>
<h2>Development Process</h2>
<p>The application was developed and used in production in three weeks.
The first phase generated the journal entries only.
The second phase looked at the file to autofill the form needed to generate the entry.
10 fields are need to complete the entry after the second phase all, but one of the fields was autofilled.
The third phase was adding the aging report and only came about because of discussions with the team to see what pain points they had in their process overall.</p>
<p>The application was built with flask and used sql alchemy to query the MSSQL database.
Additionally, the frontend used vue.js for the front end automation and ajax requests to parse the excel file.</p>
<h3>Learning</h3>
<p>At the time, I was on a Domain Driven Design kick, so I used that to build the webpage.
I really should not have because it was not a heavy domain logic problem, so the architecture added unnecessary overhead.
I had to do some really weird things, like attach the response of the handlers to the unit of work object, below is an example.</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_imports</span>():
    ...
    cmd = commands.CreateJEImports(
        imported_data=imported_data_df.to_dict(orient=<span class="hljs-string">&#x27;records&#x27;</span>),
        <span class="hljs-comment"># ...</span>
    )
    bus.handle(cmd)
    <span class="hljs-keyword">return</span> bus.uow.response  <span class="hljs-comment"># <span class="hljs-doctag">TODO:</span> see if there is a better way!</span>
</code></pre>
<p>In order to support the synchronous nature of the request/response of the webserver the message bus had to have separate methods to return a value.</p>
<pre><code class="hljs language-python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MessageBus</span>:
    ...

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_with_return_value</span>(<span class="hljs-params">self, message: Message</span>) -&gt; typing.<span class="hljs-type">Any</span>:
        <span class="hljs-string">&quot;&quot;&quot;Only handles message...
        Will not handle the events generated
        from the message (Command or Event) parameter
        &quot;&quot;&quot;</span>
        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(message, events.Event):
            logger.debug(
                <span class="hljs-string">&#x27;Handling message of type &#x27;</span>
                <span class="hljs-string">&#x27;Event with result value&#x27;</span>
            )
            <span class="hljs-keyword">try</span>:
                handler = <span class="hljs-variable language_">self</span>.event_handlers[<span class="hljs-built_in">type</span>(message)]
                <span class="hljs-keyword">return</span> handler(message)  <span class="hljs-comment"># &lt;-- Return happening here</span>
            <span class="hljs-keyword">except</span> KeyError <span class="hljs-keyword">as</span> e:
                logger.exception(
                    <span class="hljs-string">f&#x27;Exception handling Event &#x27;</span>
                    <span class="hljs-string">f&#x27;<span class="hljs-subst">{message}</span> no handler set&#x27;</span>
                )
                <span class="hljs-keyword">raise</span>
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                logger.exception(
                    <span class="hljs-string">f&#x27;Exception handling Event with &#x27;</span>
                    <span class="hljs-string">f&#x27;return value <span class="hljs-subst">{message}</span> error: <span class="hljs-subst">{e}</span>&#x27;</span>,
                    exc_info=<span class="hljs-literal">True</span>
                )
                <span class="hljs-keyword">raise</span>

        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(message, commands.Command):
            logger.debug(
                <span class="hljs-string">&#x27;Handling message of type &#x27;</span>
                <span class="hljs-string">&#x27;Command with result value&#x27;</span>
            )
            <span class="hljs-keyword">try</span>:
                handler = <span class="hljs-variable language_">self</span>.command_handlers[<span class="hljs-built_in">type</span>(message)]
                <span class="hljs-keyword">return</span> handler(message)  <span class="hljs-comment"># &lt;-- Return happening here</span>
            <span class="hljs-keyword">except</span> KeyError <span class="hljs-keyword">as</span> e:
                logger.exception(
                    <span class="hljs-string">f&#x27;Exception handling Command &#x27;</span>
                    <span class="hljs-string">f&#x27;<span class="hljs-subst">{message}</span> no handler set&#x27;</span>,
                    exc_info=<span class="hljs-literal">True</span>
                )
                <span class="hljs-keyword">raise</span>
            <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
                logger.exception(
                    <span class="hljs-string">f&#x27;Exception handling Command with &#x27;</span>
                    <span class="hljs-string">f&#x27;return value <span class="hljs-subst">{message}</span> error: <span class="hljs-subst">{e}</span>&#x27;</span>,
                    exc_info=<span class="hljs-literal">True</span>
                )
                <span class="hljs-keyword">raise</span>
</code></pre>
<p>Both of those broke the crux of the Command and Query Responsibility Segregation which was used as the architecture of the codebase.</p>
<h2>Extras</h2>
<p>Because we could leverage the current process the team used the Excel file that was parsed used tab names to delineate which one to use.</p></div></article></div></div></div></div></div></div></main><footer class="mt-32"><div class="sm:px-8"><div class="mx-auto max-w-7xl lg:px-8"><div class="border-t border-zinc-100 pt-10 pb-16 dark:border-zinc-700/40"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex flex-col items-center justify-between gap-6 sm:flex-row"><div class="flex gap-6 text-sm font-medium text-zinc-800 dark:text-zinc-200"><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/about">About</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/articles">Blog</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/work">Work</a></div><p class="text-sm text-zinc-400 dark:text-zinc-500">Â© <!-- -->2026<!-- --> Daniel Butler. All rights reserved.</p></div></div></div></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/work/revenue","query":{},"buildId":"XO_mZs14RMa7XL1ztH67e","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>